CREATE DATABASE BOOTCAMP_EX1;
use BOOTCAMP_EX1;

DROP TABLE JOB_HISTORY;
DROP TABLE EMPLOYEES;
DROP TABLE JOBS;
DROP TABLE JOB_GRADES;
DROP TABLE DEPARTMENTS;
DROP TABLE LOCATIONS;
DROP TABLE COUNTRIES;
DROP TABLE REGIONS;





CREATE TABLE REGIONS (
REGION_ID INTEGER  PRIMARY KEY,
REGION_NAME VARCHAR(25)
);

CREATE TABLE COUNTRIES (
COUNTRY_ID VARCHAR(2) PRIMARY KEY,
COUNTRY_NAME VARCHAR(40),
REGION_ID INTEGER,
FOREIGN KEY (REGION_ID) REFERENCES REGIONS (REGION_ID)
);

CREATE TABLE LOCATIONS (
LOCATION_ID INTEGER  PRIMARY KEY,
STREET_ADDRESS VARCHAR (25),
POSTAL_CODE VARCHAR(12),
CITY VARCHAR(30),
STATE_PROVINCE VARCHAR(12),
COUNTRY_ID VARCHAR(2),
FOREIGN KEY (COUNTRY_ID) REFERENCES COUNTRIES (COUNTRY_ID)
);



CREATE TABLE DEPARTMENTS(
DEPARTMENT_ID INTEGER PRIMARY KEY,
DEPARTMENT_NAME VARCHAR(30),
MANAGER_ID INTEGER,
LOCATION_ID INTEGER,
FOREIGN KEY (LOCATION_ID) REFERENCES LOCATIONS (LOCATION_ID)
);


CREATE TABLE EMPLOYEES(
	EMPLOYEE_ID INTEGER PRIMARY KEY, -- UNQIUE, NOT NULL
	FIRST_NAME VARCHAR(20),
    LAST_NAME VARCHAR(25),
	EMAIL VARCHAR(25),
    PHONE_NUMBER VARCHAR (20),
    HIRE_DATE DATE,
    SALARY INTEGER,
    COMMISSION_PCT INTEGER,
    MANAGER_ID INTEGER,
    DEPARTMENT_ID INTEGER,
    JOB_ID VARCHAR(10),
	FOREIGN KEY (DEPARTMENT_ID) REFERENCES  DEPARTMENTS (DEPARTMENT_ID),
    FOREIGN KEY (JOB_ID) REFERENCES JOBS (JOB_ID)
);

CREATE TABLE JOBS( 
 JOB_ID VARCHAR (10) PRIMARY KEY,
 JOB_TITLE VARCHAR(35),
 MIN_SALARY INTEGER,
 MAX_SALARY INTEGER, 
 GRADE_LEVEL  VARCHAR(2),
FOREIGN KEY (GRADE_LEVEL ) REFERENCES JOB_GRADES (GRADE_LEVEL )
);
 
 CREATE TABLE JOB_HISTORY(
 FOREIGN KEY (EMPLOYEE_ID ) REFERENCES  EMPLOYEES(EMPLOYEE_ID ),
 EMPLOYEE_ID INTEGER ,
 START_DATE DATE ,
 END_DATE DATE,
 JOB_ID VARCHAR(10),
 DEPARTMENT_ID INTEGER,
 FOREIGN KEY (JOB_ID) REFERENCES JOBS (JOB_ID),
 FOREIGN KEY (DEPARTMENT_ID) REFERENCES DEPARTMENTS (DEPARTMENT_ID),
 PRIMARY KEY (START_DATE, EMPLOYEE_ID)
 );
 
  CREATE TABLE JOB_GRADES(
  GRADE_LEVEL VARCHAR(2) PRIMARY KEY,
  LOWEST_SAL INTEGER,
  HIGHST_SAL INTEGER
   );
 
 INSERT INTO JOB_GRADES (GRADE_LEVEL, LOWEST_SAL,HIGHST_SAL)
 VALUE ('A', 50000, 100000);
 
  INSERT INTO JOB_GRADES (GRADE_LEVEL, LOWEST_SAL,HIGHST_SAL)
 VALUE ('B', 30000, 80000);
 
  INSERT INTO JOB_GRADES (GRADE_LEVEL, LOWEST_SAL,HIGHST_SAL)
 VALUE ('C', 20000, 40000);
 
 
 INSERT INTO REGIONS (REGION_ID, REGION_NAME)
 VALUE (1, 'Europe');
 
   INSERT INTO REGIONS (REGION_ID, REGION_NAME)
 VALUE (3, 'Japan');
 
   INSERT INTO REGIONS (REGION_ID, REGION_NAME)
 VALUE (2, 'United State');
 
 INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
 VALUES ('DE', 'Germany', 1);
 
  INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
 VALUES ('IT', 'Italy', 1);
 
   INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
 VALUES ('JP', 'Japan', 3);
 
   INSERT INTO COUNTRIES (COUNTRY_ID, COUNTRY_NAME, REGION_ID)
 VALUES ('US', 'United State', 2);
 
 
INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID) -- ADD VALUE
VALUES (1000,'1297 Via Cola di Rie', 989, 'Roma', null, 'IT' );

INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID) -- ADD VALUE
VALUES (1100,'93091 Calle della Te', 10934, 'Venice', null, 'IT' );
 
 INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID) -- ADD VALUE
VALUES (1200,'2017 Shinjuku_ku', 1689, 'Tokyo', 'TOKYO JP', 'JP');

 INSERT INTO LOCATIONS (LOCATION_ID, STREET_ADDRESS, POSTAL_CODE, CITY, STATE_PROVINCE, COUNTRY_ID) -- ADD VALUE
VALUES (1400,'2014 Jabberworcky Rd', 26192, 'Southlake', 'Texas' , 'US');
 
 INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID) 
VALUES (10,'Administration', 200, 1100 );

 INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID) 
VALUES (20, 'Marketing',201, 1200 );

 INSERT INTO DEPARTMENTS (DEPARTMENT_ID, DEPARTMENT_NAME, MANAGER_ID, LOCATION_ID) 
VALUES (10,'Administration', 200, 1100 );

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE) 
VALUES (100, 'Steven', 'King', 'SKING', '515-1234567', '1987-06-17' );

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE) 
VALUES (101, 'Neena', 'Kochhar', 'NKOCHHAR', '515-1234568', '1987-06-18' );

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE) 
VALUES (102, 'Lex',  'De Hann', 'LDEHAAN', '515-1234569', '1987-06-19' );

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE) 
VALUES (103, 'Alexander',  'hunold', 'AHUNOLD', '590-4234567', '1987-06-20' );

   INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
 VALUES ('102', 'IT_PROG', 2000, 200000); 
 
 INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
 VALUES ('101', 'MK_REP', 2000, 200000); 
 
  INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
 VALUES ('100', 'ST_CLERK', 2000, 200000); 
 
  INSERT INTO JOBS (JOB_ID, JOB_TITLE, MIN_SALARY, MAX_SALARY)
 VALUES ('103', 'MK_REP', 2000, 200000); 
 
   INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
 VALUES (102, '1993-01-13', '1998-07-24', '102', 20); 

 INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
 VALUES (101, '1989-09-21', '1993-10-27', '101', 10); 
 
  INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
 VALUES (101, '1983-10-28', '1997-03-15', '101', 30); 

 INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
 VALUES (100, '1996-02-17', '1999-12-19', '100', 30); 

 INSERT INTO JOB_HISTORY (EMPLOYEE_ID, START_DATE, END_DATE, JOB_ID, DEPARTMENT_ID)
 VALUES (103, '1998-03-24', '1999-12-31', '103', 20); 
 
 -- Error Code: 1452. Cannot add or update a child row: a foreign key constraint fails (`bootcamp_ex3`.`job_history`, CONSTRAINT `job_history_ibfk_1` FOREIGN KEY (`EMPLOYEE_ID`) REFERENCES `employess` (`EMPLOYEE_ID`))
ALTER TABLE JOBS 
ADD FOREIGN KEY (GRADE_LEVEL ) REFERENCES JOB_GRADES (GRADE_LEVEL);
 
UPDATE JOBS 
SET GRADE_LEVEL = 'C'
WHERE JOB_ID ='100';
 
UPDATE JOBS 
SET GRADE_LEVEL = 'C'
WHERE JOB_ID ='101';
 
 UPDATE JOBS 
SET GRADE_LEVEL = 'B'
WHERE JOB_ID ='102';

 UPDATE JOBS 
SET GRADE_LEVEL = 'C'
WHERE JOB_ID ='103';
 
SELECT * FROM REGIONS;
SELECT * FROM  COUNTRIES;
SELECT * FROM  LOCATIONS;
SELECT * FROM EMPLOYESS;
SELECT * FROM  DEPARTMENTS;
SELECT * FROM  JOBS;
SELECT * FROM  JOB_HISTORY;